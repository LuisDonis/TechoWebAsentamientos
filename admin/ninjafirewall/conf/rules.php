<?php
$nfw_rules = <<<'EOT'
a:84:{i:1;a:5:{s:5:"where";s:31:"GET|POST|COOKIE|HTTP_USER_AGENT";s:4:"what";s:24:"(?:\.{2}[\\/]{1,4}){2}\b";s:3:"why";s:19:"Directory traversal";s:5:"level";i:3;s:2:"on";i:1;}i:3;a:5:{s:5:"where";s:31:"GET|POST|COOKIE|HTTP_USER_AGENT";s:4:"what";s:34:"[.\\/]/(?:proc/self/|etc/passwd)\b";s:3:"why";s:20:"Local file inclusion";s:5:"level";i:2;s:2:"on";i:1;}i:50;a:5:{s:5:"where";s:31:"GET|POST|COOKIE|HTTP_USER_AGENT";s:4:"what";s:31:"^(?i:https?|ftp)://.+/[^&/]+\?$";s:3:"why";s:21:"Remote file inclusion";s:5:"level";i:3;s:2:"on";i:1;}i:51;a:5:{s:5:"where";s:22:"COOKIE|HTTP_USER_AGENT";s:4:"what";s:49:"^(?i:https?)://\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}";s:3:"why";s:30:"Remote file inclusion (URL IP)";s:5:"level";i:2;s:2:"on";i:1;}i:52;a:5:{s:5:"where";s:31:"GET|POST|COOKIE|HTTP_USER_AGENT";s:4:"what";s:61:"\b(?i:include|require)(?i:_once)?\s*\([^)]*(?i:https?|ftp)://";s:3:"why";s:43:"Remote file inclusion (via require/include)";s:5:"level";i:3;s:2:"on";i:1;}i:53;a:5:{s:5:"where";s:31:"GET|POST|COOKIE|HTTP_USER_AGENT";s:4:"what";s:33:"^(?i:ftp)://(?:.+?:.+?\@)?[^/]+/.";s:3:"why";s:27:"Remote file inclusion (FTP)";s:5:"level";i:2;s:2:"on";i:1;}i:100;a:5:{s:5:"where";s:39:"GET|COOKIE|HTTP_USER_AGENT|HTTP_REFERER";s:4:"what";s:85:"<\s*/?(?i:applet|div|embed|i?frame(?:set)?|meta|marquee|object|script|textarea)\b.*?>";s:3:"why";s:14:"XSS (HTML tag)";s:5:"level";i:2;s:2:"on";i:1;}i:101;a:5:{s:5:"where";s:39:"GET|COOKIE|HTTP_USER_AGENT|HTTP_REFERER";s:4:"what";s:67:"\W(?:background(-image)?|-moz-binding)\s*:[^}]*?\burl\s*\([^)]+?://";s:3:"why";s:27:"XSS (remote background URI)";s:5:"level";i:3;s:2:"on";i:1;}i:102;a:5:{s:5:"where";s:39:"GET|COOKIE|HTTP_USER_AGENT|HTTP_REFERER";s:4:"what";s:80:"(?i:<[^>]+?(?:data|href|src)\s*=\s*['\"]?(?:https?|data|php|(?:java|vb)script):)";s:3:"why";s:16:"XSS (remote URI)";s:5:"level";i:3;s:2:"on";i:1;}i:103;a:5:{s:5:"where";s:39:"GET|COOKIE|HTTP_USER_AGENT|HTTP_REFERER";s:4:"what";s:157:"\b(?i:on(?i:abort|blur|(?:dbl)?click|dragdrop|error|focus|key(?:up|down|press)|(?:un)?load|mouse(?:down|out|over|up)|move|res(?:et|ize)|select|submit))\b\s*=";s:3:"why";s:16:"XSS (HTML event)";s:5:"level";i:2;s:2:"on";i:1;}i:104;a:5:{s:5:"where";s:44:"GET|POST|COOKIE|HTTP_USER_AGENT|HTTP_REFERER";s:4:"what";s:85:"[:=\]]\s*['\"]?(?:alert|confirm|eval|expression|prompt|String\.fromCharCode|url)\s*\(";s:3:"why";s:17:"XSS (JS function)";s:5:"level";i:3;s:2:"on";i:1;}i:105;a:5:{s:5:"where";s:44:"GET|POST|COOKIE|HTTP_USER_AGENT|HTTP_REFERER";s:4:"what";s:56:"\bdocument\.(?:body|cookie|location|open|write(?:ln)?)\b";s:3:"why";s:21:"XSS (document object)";s:5:"level";i:2;s:2:"on";i:1;}i:106;a:5:{s:5:"where";s:44:"GET|POST|COOKIE|HTTP_USER_AGENT|HTTP_REFERER";s:4:"what";s:30:"\blocation\.(?:href|replace)\b";s:3:"why";s:21:"XSS (location object)";s:5:"level";i:2;s:2:"on";i:1;}i:107;a:5:{s:5:"where";s:44:"GET|POST|COOKIE|HTTP_USER_AGENT|HTTP_REFERER";s:4:"what";s:29:"\bwindow\.(?:open|location)\b";s:3:"why";s:19:"XSS (window object)";s:5:"level";i:2;s:2:"on";i:1;}i:108;a:5:{s:5:"where";s:44:"GET|POST|COOKIE|HTTP_USER_AGENT|HTTP_REFERER";s:4:"what";s:33:"(?i:style)\s*=\s*['\"]?[^'\"]+/\*";s:3:"why";s:22:"XSS (obfuscated style)";s:5:"level";i:3;s:2:"on";i:1;}i:109;a:5:{s:5:"where";s:44:"GET|POST|COOKIE|HTTP_USER_AGENT|HTTP_REFERER";s:4:"what";s:4:"^/?>";s:3:"why";s:31:"XSS (leading greater-than sign)";s:5:"level";i:2;s:2:"on";i:1;}i:110;a:5:{s:5:"where";s:12:"QUERY_STRING";s:4:"what";s:18:"(?:%%\d\d%\d\d){5}";s:3:"why";s:19:"XSS (double nibble)";s:5:"level";i:2;s:2:"on";i:1;}i:111;a:5:{s:5:"where";s:56:"GET|POST|REQUEST_URI|COOKIE|HTTP_USER_AGENT|HTTP_REFERER";s:4:"what";s:48:"(\+|\%2B)A(Dw|ACIAPgA8)-.+?(\+|\%2B)AD4(APAAi)?-";s:3:"why";s:11:"XSS (UTF-7)";s:5:"level";i:2;s:2:"on";i:1;}i:150;a:5:{s:5:"where";s:8:"GET|POST";s:4:"what";s:59:"[\n\r]\s*\b(?:(?:reply-)?to|b?cc|content-[td]\w)\b\s*:.*?\@";s:3:"why";s:21:"Mail header injection";s:5:"level";i:2;s:2:"on";i:1;}i:153;a:5:{s:5:"where";s:44:"GET|POST|COOKIE|HTTP_USER_AGENT|HTTP_REFERER";s:4:"what";s:56:"<!--#(?:config|echo|exec|flastmod|fsize|include)\b.+?-->";s:3:"why";s:21:"SSI command injection";s:5:"level";i:2;s:2:"on";i:1;}i:154;a:5:{s:5:"where";s:35:"COOKIE|HTTP_USER_AGENT|HTTP_REFERER";s:4:"what";s:31:"(?s:<\?.+)|#!/(?:usr|bin)/.+?\s";s:3:"why";s:14:"Code injection";s:5:"level";i:3;s:2:"on";i:1;}i:155;a:5:{s:5:"where";s:8:"GET|POST";s:4:"what";s:360:"(?s:<\?(?![Xx][Mm][Ll]).*?(?:\$_?(?:COOKIE|ENV|FILES|GLOBALS|(?:GE|POS|REQUES)T|SE(RVER|SSION))\s*[=\[)]|\b(?i:array_map|assert|base64_(?:de|en)code|curl_exec|eval|file(?:_get_contents)?|fsockopen|gzinflate|move_uploaded_file|passthru|preg_replace|phpinfo|stripslashes|strrev|system|(?:shell_)?exec)\s*\()|\x60.+?\x60)|#!/(?:usr|bin)/.+?\s|\W\$\{\s*['"]\w+['"]";s:3:"why";s:14:"Code injection";s:5:"level";i:3;s:2:"on";i:1;}i:156;a:5:{s:5:"where";s:8:"GET|POST";s:4:"what";s:115:"\b(?i:eval)\s*\(\s*(?i:base64_decode|exec|file_get_contents|gzinflate|passthru|shell_exec|stripslashes|system)\s*\(";s:3:"why";s:17:"Code injection #2";s:5:"level";i:2;s:2:"on";i:1;}i:157;a:5:{s:5:"where";s:8:"GET:fltr";s:4:"what";s:1:";";s:3:"why";s:25:"Code injection (phpThumb)";s:5:"level";i:3;s:2:"on";i:1;}i:158;a:5:{s:5:"where";s:17:"GET:phpThumbDebug";s:4:"what";s:1:".";s:3:"why";s:36:"phpThumb debug mode (potential SSRF)";s:5:"level";i:3;s:2:"on";i:1;}i:159;a:5:{s:5:"where";s:7:"GET:src";s:4:"what";s:2:"\$";s:3:"why";s:46:"TimThumb WebShot Remote Code Execution (0-day)";s:5:"level";i:3;s:2:"on";i:1;}i:160;a:5:{s:5:"where";s:10:"GET|SERVER";s:4:"what";s:16:"^\s*\(\s*\)\s*\{";s:3:"why";s:40:"Shellshock vulnerability (CVE-2014-6271)";s:5:"level";i:3;s:2:"on";i:1;}i:161;a:5:{s:5:"where";s:19:"SERVER:HTTP_REFERER";s:4:"what";s:16:"\?a=\$stylevar\b";s:3:"why";s:37:"vBulletin vBSEO remote code injection";s:5:"level";i:3;s:2:"on";i:1;}i:200;a:5:{s:5:"where";s:15:"GET|POST|COOKIE";s:4:"what";s:44:"^(?i:admin(?:istrator)?)['\"].*?(?:--|#|/\*)";s:3:"why";s:35:"SQL injection (admin login attempt)";s:5:"level";i:3;s:2:"on";i:1;}i:201;a:5:{s:5:"where";s:8:"GET|POST";s:4:"what";s:72:"\b(?i:[-\w]+@(?:[-a-z0-9]+\.)+[a-z]{2,8}'.{0,20}\band\b.{0,20}=[\s/*]*')";s:3:"why";s:34:"SQL injection (user login attempt)";s:5:"level";i:3;s:2:"on";i:1;}i:202;a:5:{s:5:"where";s:26:"GET:username|POST:username";s:4:"what";s:20:"[#'\"=(),<>/\\*\x60]";s:3:"why";s:24:"SQL injection (username)";s:5:"level";i:3;s:2:"on";i:1;}i:204;a:5:{s:5:"where";s:44:"GET|POST|COOKIE|HTTP_USER_AGENT|HTTP_REFERER";s:4:"what";s:60:"\b(?i:and|or|having)\b.+?['"]?\b(\w+)\b['"]?\s*=\s*['"]?\1\b";s:3:"why";s:30:"SQL injection (equal operator)";s:5:"level";i:3;s:2:"on";i:1;}i:205;a:5:{s:5:"where";s:8:"GET|POST";s:4:"what";s:67:"(?i:(?:\b(?:and|or|union)\b|;|').*?\bfrom\b.+?information_schema\b)";s:3:"why";s:34:"SQL injection (information_schema)";s:5:"level";i:3;s:2:"on";i:1;}i:206;a:5:{s:5:"where";s:8:"GET|POST";s:4:"what";s:53:"/\*\*/(?i:and|from|limit|or|select|union|where)/\*\*/";s:3:"why";s:35:"SQL injection (comment obfuscation)";s:5:"level";i:3;s:2:"on";i:1;}i:207;a:5:{s:5:"where";s:3:"GET";s:4:"what";s:30:"^[-\d';].+\w.+(?:--|#|/\*)\s*$";s:3:"why";s:32:"SQL injection (trailing comment)";s:5:"level";i:3;s:2:"on";i:1;}i:208;a:5:{s:5:"where";s:35:"COOKIE|HTTP_USER_AGENT|HTTP_REFERER";s:4:"what";s:162:"(?i:(?:\b(?:and|or|union)\b|;|').*?\b(?:alter|create|delete|drop|grant|information_schema|insert|load|rename|select|truncate|update)\b.+?\b(?:from|into|on|set)\b)";s:3:"why";s:13:"SQL injection";s:5:"level";i:1;s:2:"on";i:1;}i:209;a:5:{s:5:"where";s:8:"GET|POST";s:4:"what";s:227:"(?i:(?:\b(?:and|or|union)\b|;|').*?(?:\ball\b.+?)?\bselect\b.+?\b(?:and\b|from\b|limit\b|where\b|\@?\@?version\b|(?:user|benchmark|char|count|database|(?:group_)?concat(?:_ws)?|floor|md5|rand|substring|version)\s*\(|--|/\*|#$))";s:3:"why";s:22:"SQL injection (select)";s:5:"level";i:3;s:2:"on";i:1;}i:210;a:5:{s:5:"where";s:8:"GET|POST";s:4:"what";s:98:"(?i:(?:\b(?:and|or|union)\b|;|').*?(?:\ball\b.+?)?\binsert\b.+?\binto\b.*?\([^)]+\).+?values.*?\()";s:3:"why";s:22:"SQL injection (insert)";s:5:"level";i:3;s:2:"on";i:1;}i:211;a:5:{s:5:"where";s:8:"GET|POST";s:4:"what";s:60:"(?i:(?:\b(?:and|or|union)\b|;|').*?\bupdate\b.+?\bset\b.+?=)";s:3:"why";s:22:"SQL injection (update)";s:5:"level";i:3;s:2:"on";i:1;}i:212;a:5:{s:5:"where";s:3:"GET";s:4:"what";s:62:"(?i:(?:\b(?:and|or|union)\b|;|').*?\bgrant\b.+?\bon\b.+?to\s+)";s:3:"why";s:21:"SQL injection (grant)";s:5:"level";i:3;s:2:"on";i:1;}i:213;a:5:{s:5:"where";s:8:"GET|POST";s:4:"what";s:59:"(?i:(?:\b(?:and|or|union)\b|;|').*?\bdelete\b.+?\bfrom\b.+)";s:3:"why";s:22:"SQL injection (delete)";s:5:"level";i:3;s:2:"on";i:1;}i:214;a:5:{s:5:"where";s:8:"GET|POST";s:4:"what";s:130:"(?i:(?:\b(?:and|or|union)\b|;|').*?\b(alter|create|drop)\b.+?(?:DATABASE|FUNCTION|INDEX|PROCEDURE|SCHEMA|TABLE|TRIGGER|VIEW)\b.+?)";s:3:"why";s:33:"SQL injection (alter/create/drop)";s:5:"level";i:3;s:2:"on";i:1;}i:215;a:5:{s:5:"where";s:8:"GET|POST";s:4:"what";s:67:"(?i:(?:\b(?:and|or|union)\b|;|').*?\b(?:rename|truncate)\b.+?table)";s:3:"why";s:31:"SQL injection (rename/truncate)";s:5:"level";i:3;s:2:"on";i:1;}i:216;a:5:{s:5:"where";s:8:"GET|POST";s:4:"what";s:112:"(?i:(?:\b(?:and|or|union)\b|;|').*?\bselect\b.+?\b(?:into\b.+?(?:(?:dump|out)file|\@['\"\x60]?\w+)|load_file))\b";s:3:"why";s:37:"SQL injection (select into/load_file)";s:5:"level";i:3;s:2:"on";i:1;}i:217;a:5:{s:5:"where";s:8:"GET|POST";s:4:"what";s:77:"(?i:(?:\b(?:and|or|union)\b|;|').*?load\b.+?\bdata\b.+?\binfile\b.+?\binto)\b";s:3:"why";s:20:"SQL injection (load)";s:5:"level";i:3;s:2:"on";i:1;}i:218;a:5:{s:5:"where";s:8:"GET|POST";s:4:"what";s:29:"\b(?i:waitfor\b\W*?\bdelay)\b";s:3:"why";s:26:"SQL injection (time-based)";s:5:"level";i:2;s:2:"on";i:1;}i:219;a:5:{s:5:"where";s:3:"GET";s:4:"what";s:39:"(?i:\bbenchmark\s*\(\d+\s*,\s*md5\s*\()";s:3:"why";s:25:"SQL injection (benchmark)";s:5:"level";i:2;s:2:"on";i:1;}i:250;a:5:{s:5:"where";s:9:"HTTP_HOST";s:4:"what";s:20:"[^-a-zA-Z0-9._:\[\]]";s:3:"why";s:21:"Malformed Host header";s:5:"level";i:2;s:2:"on";i:1;}i:300;a:5:{s:5:"where";s:3:"GET";s:4:"what";s:6:"^['\"]";s:3:"why";s:13:"Leading quote";s:5:"level";i:2;s:2:"on";i:1;}i:301;a:5:{s:5:"where";s:3:"GET";s:4:"what";s:11:"^[\x09\x20]";s:3:"why";s:13:"Leading space";s:5:"level";i:1;s:2:"on";i:1;}i:302;a:5:{s:5:"where";s:22:"QUERY_STRING|PATH_INFO";s:4:"what";s:44:"\bHTTP_RAW_POST_DATA|HTTP_(?:POS|GE)T_VARS\b";s:3:"why";s:12:"PHP variable";s:5:"level";i:2;s:2:"on";i:1;}i:303;a:5:{s:5:"where";s:11:"SCRIPT_NAME";s:4:"what";s:12:"phpinfo\.php";s:3:"why";s:29:"Attempt to access phpinfo.php";s:5:"level";i:1;s:2:"on";i:1;}i:304;a:5:{s:5:"where";s:11:"SCRIPT_NAME";s:4:"what";s:30:"/scripts/(?:setup|signon)\.php";s:3:"why";s:26:"phpMyAdmin hacking attempt";s:5:"level";i:2;s:2:"on";i:1;}i:305;a:5:{s:5:"where";s:11:"SCRIPT_NAME";s:4:"what";s:24:"\.ph(?:p[2-6]?|tml)\..+?";s:3:"why";s:23:"PHP handler obfuscation";s:5:"level";i:3;s:2:"on";i:1;}i:309;a:5:{s:5:"where";s:65:"QUERY_STRING|PATH_INFO|COOKIE|SERVER:HTTP_USER_AGENT|HTTP_REFERER";s:4:"what";s:141:"\b(?:\$?_(COOKIE|ENV|FILES|(?:GE|POS|REQUES)T|SE(RVER|SSION))|HTTP_(?:(?:POST|GET)_VARS|RAW_POST_DATA)|GLOBALS)\s*[=\[)]|\W\$\{\s*['"]\w+['"]";s:3:"why";s:24:"PHP predefined variables";s:5:"level";i:2;s:2:"on";i:1;}i:310;a:5:{s:5:"where";s:11:"SCRIPT_NAME";s:4:"what";s:118:"(?i:(?:conf(?:ig(?:ur(?:e|ation)|\.inc|_global)?)?)|settings?(?:\.?inc)?|\b(?:db(?:connect)?|connect)(?:\.?inc)?)\.php";s:3:"why";s:30:"Access to a configuration file";s:5:"level";i:2;s:2:"on";i:1;}i:311;a:5:{s:5:"where";s:11:"SCRIPT_NAME";s:4:"what";s:40:"/tiny_?mce/plugins/spellchecker/classes/";s:3:"why";s:23:"TinyMCE path disclosure";s:5:"level";i:2;s:2:"on";i:1;}i:312;a:5:{s:5:"where";s:20:"HTTP_X_FORWARDED_FOR";s:4:"what";s:24:"[^.0-9a-fA-F:\x20,unkow]";s:3:"why";s:29:"Non-compliant X_FORWARDED_FOR";s:5:"level";i:1;s:2:"on";i:1;}i:313;a:5:{s:5:"where";s:12:"QUERY_STRING";s:4:"what";s:14:"^-[bcndfiswzT]";s:3:"why";s:31:"PHP-CGI exploit (CVE-2012-1823)";s:5:"level";i:3;s:2:"on";i:1;}i:314;a:5:{s:5:"where";s:19:"SERVER:HTTP_REFERER";s:4:"what";s:175:"^http://(?:7zap|best(?:bowling|-seo-solution)|buttons-for-(?:your-)website|chimiver|darodar|doska-vsem|hulfingtonpost|make-money-online|www\.rankalexa|semalt|www\.valegames)\.";s:3:"why";s:13:"Referrer spam";s:5:"level";i:1;s:2:"on";i:1;}i:315;a:5:{s:5:"where";s:97:"GET|HTTP_HOST|SERVER_PROTOCOL|SERVER:HTTP_USER_AGENT|QUERY_STRING|SERVER:HTTP_REFERER|HTTP_COOKIE";s:4:"what";s:41:">\s*/dev/(?:tc|ud)p/[^/]{5,255}/\d{1,5}\b";s:3:"why";s:56:"/dev TCP/UDP device file access (possible reverse shell)";s:5:"level";i:3;s:2:"on";i:1;}i:350;a:5:{s:5:"where";s:11:"SCRIPT_NAME";s:4:"what";s:186:"(?i:bypass|c99(?:madShell|ud)?|c100|cookie_(?:usage|setup)|diagnostics|dump|endix|gifimg|goog[l1]e.+[\da-f]{10}|imageth|imlog|r5[47]|safe0ver|sniper|(?:jpe?g|gif|png))\.ph(?:p[2-6]?|tml)";s:3:"why";s:14:"Shell/backdoor";s:5:"level";i:3;s:2:"on";i:1;}i:351;a:5:{s:5:"where";s:28:"GET:nixpasswd|POST:nixpasswd";s:4:"what";s:3:"^.?";s:3:"why";s:26:"Shell/backdoor (nixpasswd)";s:5:"level";i:3;s:2:"on";i:1;}i:352;a:5:{s:5:"where";s:12:"QUERY_STRING";s:4:"what";s:16:"\bact=img&img=\w";s:3:"why";s:20:"Shell/backdoor (img)";s:5:"level";i:3;s:2:"on";i:1;}i:353;a:5:{s:5:"where";s:12:"QUERY_STRING";s:4:"what";s:15:"\bc=img&name=\w";s:3:"why";s:21:"Shell/backdoor (name)";s:5:"level";i:3;s:2:"on";i:1;}i:354;a:5:{s:5:"where";s:12:"QUERY_STRING";s:4:"what";s:36:"^image=(?:arrow|file|folder|smiley)$";s:3:"why";s:22:"Shell/backdoor (image)";s:5:"level";i:3;s:2:"on";i:1;}i:355;a:5:{s:5:"where";s:6:"COOKIE";s:4:"what";s:21:"\buname=.+?;\ssysctl=";s:3:"why";s:23:"Shell/backdoor (cookie)";s:5:"level";i:3;s:2:"on";i:1;}i:356;a:5:{s:5:"where";s:30:"POST:sql_passwd|GET:sql_passwd";s:4:"what";s:1:".";s:3:"why";s:27:"Shell/backdoor (sql_passwd)";s:5:"level";i:3;s:2:"on";i:1;}i:357;a:5:{s:5:"where";s:12:"POST:nowpath";s:4:"what";s:3:"^.?";s:3:"why";s:24:"Shell/backdoor (nowpath)";s:5:"level";i:3;s:2:"on";i:1;}i:358;a:5:{s:5:"where";s:18:"POST:view_writable";s:4:"what";s:3:"^.?";s:3:"why";s:30:"Shell/backdoor (view_writable)";s:5:"level";i:3;s:2:"on";i:1;}i:359;a:5:{s:5:"where";s:6:"COOKIE";s:4:"what";s:13:"\bphpspypass=";s:3:"why";s:23:"Shell/backdoor (phpspy)";s:5:"level";i:3;s:2:"on";i:1;}i:360;a:5:{s:5:"where";s:6:"POST:a";s:4:"what";s:90:"^(?:Bruteforce|Console|Files(?:Man|Tools)|Network|Php|SecInfo|SelfRemove|Sql|StringTools)$";s:3:"why";s:18:"Shell/backdoor (a)";s:5:"level";i:3;s:2:"on";i:1;}i:361;a:5:{s:5:"where";s:12:"POST:nst_cmd";s:4:"what";s:2:"^.";s:3:"why";s:24:"Shell/backdoor (nstview)";s:5:"level";i:3;s:2:"on";i:1;}i:362;a:5:{s:5:"where";s:8:"POST:cmd";s:4:"what";s:206:"^(?:c(?:h_|URL)|db_query|echo\s\\.*|(?:edit|download|save)_file|find(?:_text|\s.+)|ftp_(?:brute|file_(?:down|up))|mail_file|mk|mysql(?:b|_dump)|php_eval|ps\s.*|search_text|safe_dir|sym[1-2]|test[1-8]|zend)$";s:3:"why";s:20:"Shell/backdoor (cmd)";s:5:"level";i:2;s:2:"on";i:1;}i:363;a:5:{s:5:"where";s:5:"GET:p";s:4:"what";s:65:"^(?:chmod|cmd|edit|eval|delete|headers|md5|mysql|phpinfo|rename)$";s:3:"why";s:18:"Shell/backdoor (p)";s:5:"level";i:3;s:2:"on";i:1;}i:364;a:5:{s:5:"where";s:12:"QUERY_STRING";s:4:"what";s:139:"^act=(?:bind|cmd|encoder|eval|feedback|ftpquickbrute|gofile|ls|mkdir|mkfile|processes|ps_aux|search|security|sql|tools|update|upload)&d=%2F";s:3:"why";s:20:"Shell/backdoor (act)";s:5:"level";i:3;s:2:"on";i:1;}i:365;a:5:{s:5:"where";s:10:"FILES:F1l3";s:4:"what";s:2:"^.";s:3:"why";s:22:"Potential PHP backdoor";s:5:"level";i:3;s:2:"on";i:1;}i:366;a:6:{s:5:"where";s:16:"POST:contenttype";s:4:"what";s:14:"(?:plain|html)";s:3:"why";s:29:"Potential mass-mailing script";s:5:"level";i:3;s:2:"on";i:1;s:5:"extra";a:3:{i:1;s:4:"POST";i:2;s:6:"action";i:3;s:4:"send";}}i:2;a:5:{s:5:"where";s:89:"GET|POST|COOKIE|SERVER:HTTP_USER_AGENT|SERVER:HTTP_REFERER|REQUEST_URI|PHP_SELF|PATH_INFO";s:4:"what";s:8:"%00|\x00";s:3:"why";s:32:"ASCII character 0x00 (NULL byte)";s:5:"level";i:3;s:2:"on";i:1;}i:500;a:5:{s:5:"where";s:44:"GET|POST|COOKIE|HTTP_USER_AGENT|HTTP_REFERER";s:4:"what";s:20:"[\x01-\x08\x0e-\x1f]";s:3:"why";s:46:"ASCII control characters (1 to 8 and 14 to 31)";s:5:"level";i:2;s:2:"on";i:1;}i:510;a:5:{s:5:"where";s:20:"GET|POST|REQUEST_URI";s:4:"what";s:9:"/var/www/";s:3:"why";s:45:"DOCUMENT_ROOT server variable in HTTP request";s:5:"level";i:2;s:2:"on";i:1;}i:520;a:5:{s:5:"where";s:58:"GET|POST|COOKIE|SERVER:HTTP_USER_AGENT|SERVER:HTTP_REFERER";s:4:"what";s:45:"\b(?i:ph(p|ar)://[a-z].+?|\bdata:.*?;base64,)";s:3:"why";s:21:"PHP built-in wrappers";s:5:"level";i:3;s:2:"on";i:1;}i:531;a:5:{s:5:"where";s:15:"HTTP_USER_AGENT";s:4:"what";s:329:"(?i:acunetix|analyzer|AhrefsBot|backdoor|bandit|blackwidow|BOT for JCE|collect|core-project|dts agent|emailmagnet|ex(ploit|tract)|flood|grabber|harvest|httrack|havij|hunter|indy library|inspect|LoadTimeBot|Microsoft URL Control|Miami Style|mj12bot|morfeus|nessus|pmafind|scanner|siphon|spbot|sqlmap|survey|teleport|updown_tester)";s:3:"why";s:24:"Suspicious bots/scanners";s:5:"level";i:1;s:2:"on";i:1;}i:540;a:5:{s:5:"where";s:8:"GET|POST";s:4:"what";s:33:"^(?i:127\.0\.0\.1|localhost|::1)$";s:3:"why";s:32:"Localhost IP in GET/POST request";s:5:"level";i:2;s:2:"on";i:0;}}
EOT;
